<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>متجر إلكتروني</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: 'Cairo', sans-serif; margin: 0; padding: 0; direction: rtl; }
    .popup, .section { padding: 1em; margin: 1em; border: 1px solid #ccc; border-radius: 8px; }
    .popup { background: #f9f9f9; }
    .product { padding: 0.5em; border-bottom: 1px solid #ddd; }
    .out-of-stock { background-color: #ffe6e6; color: red; font-weight: bold; padding: 0.5em; margin-top: 0.5em; }
    .available { color: green; font-weight: bold; }
    .unavailable { color: red; font-weight: bold; }
  </style>
</head>
<body><!-- Popup لاختيار الموقع --><div class="popup" id="locationPopup">
  <h3>اختر المدينة والحي</h3>
  <label>المدينة:</label>
  <select id="citySelect">
    <option value="الرياض">الرياض</option>
  </select>
  <label>الحي:</label>
  <select id="districtSelect">
    <option value="المعذر">حي المعذر</option>
    <option value="الورود">حي الورود</option>
  </select>
  <button onclick="confirmLocation()">تأكيد</button>
</div><!-- المنتجات --><div class="section" id="productsSection" style="display:none">
  <h3>المنتجات</h3>
  <div class="product" data-name="قلاية هوائية">قلاية هوائية <button onclick="addToCart('قلاية هوائية')">إضافة</button></div>
  <div class="product" data-name="ماكينة قهوة">ماكينة قهوة <button onclick="addToCart('ماكينة قهوة')">إضافة</button></div>
  <div class="product" data-name="مايكروييف">مايكروييف <button onclick="addToCart('مايكروييف')">إضافة</button></div>
</div><!-- صفحة إكمال الطلب --><div class="section" id="checkoutSection" style="display:none">
  <h3>إكمال الطلب</h3>
  <div>
    <strong>طريقة الشحن:</strong><br>
    <div id="deliveryOption"></div>
    <div id="pickupOption"></div>
  </div>
  <h4>سلة المنتجات</h4>
  <div id="cartItems"></div>
</div><script>
const stock = {
  'قلاية هوائية': { الكتروني: false, الورود: true, المعذر: false },
  'ماكينة قهوة': { الكتروني: true, الورود: false, المعذر: false },
  'مايكروييف': { الكتروني: true, الورود: true, المعذر: false },
};
let district = '';
let cart = [];

function confirmLocation() {
  district = document.getElementById('districtSelect').value;
  document.getElementById('locationPopup').style.display = 'none';
  document.getElementById('productsSection').style.display = 'block';
}

function addToCart(product) {
  cart.push(product);
  alert(`${product} تمت إضافته للسلة`);
  showCheckout();
}

function showCheckout() {
  document.getElementById('checkoutSection').style.display = 'block';
  const cartDisplay = document.getElementById('cartItems');
  cartDisplay.innerHTML = '';

  let deliveryCount = 0;
  let pickupCount = 0;
  cart.forEach(product => {
    const isAvailableDelivery = stock[product].الكتروني;
    const isAvailablePickup = stock[product][district];

    if (isAvailableDelivery) deliveryCount++;
    if (isAvailablePickup) pickupCount++;

    cartDisplay.innerHTML += `
      <div>
        ${product}
        ${!isAvailableDelivery && !isAvailablePickup ? `<div class="out-of-stock">غير متوفر <button onclick="removeFromCart('${product}')">حذف</button></div>` : ''}
      </div>
    `;
  });

  // خيارات الشحن
  document.getElementById('deliveryOption').innerHTML = `
    <p>توصيل منزلي - (${deliveryCount} من ${cart.length}) من المنتجات متوفرة</p>
  `;

  document.getElementById('pickupOption').innerHTML = `
    <p>استلام من المعرض - (${pickupCount} من ${cart.length}) من المنتجات متوفرة</p>
    <ul>
      <li>معرض حي الورود: <span class="${checkAvailability('الورود') ? 'available' : 'unavailable'}">${checkAvailability('الورود') ?
